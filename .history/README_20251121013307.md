# ü§ñ RAG Chatbot with Guardrails

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö RAG (Retrieval-Augmented Generation) Chatbot ‡∏ó‡∏µ‡πà‡∏°‡∏µ safety guardrails ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ 20 ‡∏â‡∏ö‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ AI ‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÅ‡∏ï‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡πà‡∏≠‡∏ô
‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏Ñ‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ 3 ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡πÜ: ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å‡∏Ñ‡∏∑‡∏≠‡∏™‡πà‡∏ß‡∏ô Retrieval ‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≤‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å‡πÜ (chunks) ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 156 ‡∏Ñ‡∏≥‡∏ï‡πà‡∏≠‡∏ä‡∏¥‡πâ‡∏ô ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 933 ‡∏ä‡∏¥‡πâ‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô embeddings ‡∏î‡πâ‡∏ß‡∏¢ BGE-base model ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô AI model ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πà‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏•‡∏á‡πÉ‡∏ô vector database (ChromaDB) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß
‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠‡∏™‡πà‡∏ß‡∏ô Generation ‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å database ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏´‡πâ Gemini AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÇ‡∏î‡∏¢‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏≤‡πÄ‡∏à‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏ï‡πà‡∏á‡πÄ‡∏≠‡∏á
‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠ Guardrails ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ Bielik-Guard model ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö keyword filtering ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏®‡∏≤‡∏™‡∏ô‡∏≤ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô
‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡πÉ‡∏ä‡πâ model ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ (MiniLM) ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ accuracy ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 68% ‡πÅ‡∏•‡πâ‡∏ß‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÑ‡∏õ‡πÉ‡∏ä‡πâ BGE-base model ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ accuracy ‡∏ñ‡∏∂‡∏á 85% ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏•‡∏î chunk size ‡∏•‡∏á‡∏à‡∏≤‡∏Å 300 ‡∏Ñ‡∏≥‡πÄ‡∏õ‡πá‡∏ô 156 ‡∏Ñ‡∏≥ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ similarity score ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≤‡∏Å 0.47 ‡πÄ‡∏õ‡πá‡∏ô 0.62 ‡∏´‡∏£‡∏∑‡∏≠‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ñ‡∏∂‡∏á 32%
‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠ web application ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô Streamlit ‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡πÄ‡∏à‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏° similarity score ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö settings ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏ä‡πà‡∏ô similarity threshold, topic filtering, ‡πÅ‡∏•‡∏∞ keyword blocking ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1.5-3.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÉ‡∏ä‡πâ RAM ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 650MB ‡πÅ‡∏•‡∏∞‡∏°‡∏µ accuracy ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° single-passage ‡∏ó‡∏µ‡πà 85% 



## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô 3 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:
1. **Search**: ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å documents (933 chunks)
2. **Generate**: ‡πÉ‡∏ä‡πâ Gemini API ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏≤‡πÑ‡∏î‡πâ
3. **Filter**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢ Bielik-Guard + keyword filtering

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

```
RAG_SERVICE/
‚îÇ
‚îú‚îÄ‚îÄ  APPLICATIONS (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡πÉ‡∏î‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏∂‡πà‡∏á)
‚îÇ   ‚îú‚îÄ‚îÄ app_guardrail_bielik.py          ‚≠ê ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥!)
‚îÇ   ‚îÇ                                       - ‡πÉ‡∏ä‡πâ Bielik-Guard AI model
‚îÇ   ‚îÇ                                       - ‡πÉ‡∏ä‡πâ BGE-base embeddings (‡πÅ‡∏°‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤)
‚îÇ   ‚îÇ                                       - UI ‡∏Ñ‡∏£‡∏ö, settings ‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ app_guardrail_model.py           ‚ùå embeding + classifier
‚îÇ                                           - ‡∏™‡πà‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÇ‡∏ä‡∏ß‡πå‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤
‚îÇ                                            
‚îÇ
‚îú‚îÄ‚îÄ CONFIGURATION
‚îÇ   ‚îú‚îÄ‚îÄ .env                              ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏á! (‡πÉ‡∏™‡πà GEMINI_API_KEY)
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt                  ‡πÉ‡∏ä‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies
‚îÇ   ‚îî‚îÄ‚îÄ README.md                        üìñ ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
‚îÇ
‚îú‚îÄ‚îÄ DATA
‚îÇ   ‚îî‚îÄ‚îÄ data_rag/
‚îÇ       ‚îú‚îÄ‚îÄ documents.csv                         ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö (20 docs)
‚îÇ       ‚îú‚îÄ‚îÄ single_passage_answer_questions.csv   ‡∏ó‡∏î‡∏™‡∏≠‡∏ö (40 ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°)
‚îÇ       ‚îú‚îÄ‚îÄ multi_passage_answer_questions.csv    ‡∏ó‡∏î‡∏™‡∏≠‡∏ö (40 ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°)
‚îÇ       ‚îî‚îÄ‚îÄ no_answer_questions.csv               ‡∏ó‡∏î‡∏™‡∏≠‡∏ö (40 ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°)
‚îÇ
‚îú‚îÄ‚îÄ NOTEBOOKS (Pipeline ‡∏™‡∏£‡πâ‡∏≤‡∏á RAG System)
‚îÇ   ‚îî‚îÄ‚îÄ notebooks/
‚îÇ       ‚îú‚îÄ‚îÄ 01_eda.ipynb                 ‚ÑπÔ∏è Optional - ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
‚îÇ       ‚îÇ                                   ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á eda_summary.json
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ 02_chunking_embedding.ipynb  ‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç! - ‡∏™‡∏£‡πâ‡∏≤‡∏á embeddings
‚îÇ       ‚îÇ                                   Input: documents.csv
‚îÇ       ‚îÇ                                   Output: chunks_bge/
‚îÇ       ‚îÇ                                   ‡πÄ‡∏ß‡∏•‡∏≤: ~3-5 ‡∏ô‡∏≤‡∏ó‡∏µ
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ 03_vector_database.ipynb     ‚≠ê ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç! - ‡∏™‡∏£‡πâ‡∏≤‡∏á ChromaDB
‚îÇ       ‚îÇ                                   Input: chunks_bge/
‚îÇ       ‚îÇ                                   Output: chroma_db_bge/
‚îÇ       ‚îÇ                                   ‡πÄ‡∏ß‡∏•‡∏≤: ~1-2 ‡∏ô‡∏≤‡∏ó‡∏µ
‚îÇ       ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ eda_summary.json             ‚ÑπÔ∏è Output ‡∏à‡∏≤‡∏Å notebook 1
‚îÇ
‚îú‚îÄ‚îÄ GUARDRAIL (Optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö train custom model)
‚îÇ   ‚îî‚îÄ‚îÄ guardrail_script/
‚îÇ       ‚îú‚îÄ‚îÄ train_binary.ipynb           ‚ùå script ‡∏™‡∏£‡πâ‡∏≤‡∏á guardrail ‡πÅ‡∏ö‡∏ö embeding +classifier
‚îÇ       ‚îî‚îÄ‚îÄ test_benchmark.ipynb         ‚ùå script ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏á guardrail ‡∏°‡∏µ‡∏Ç‡∏≠‡∏á 
‚îÇ                                            ‡∏°‡∏µ‡∏Ç‡∏≠‡∏á Bielik-Guard ‡∏î‡πâ‡∏ß‡∏¢ ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞
‚îÇ
‚îú‚îÄ‚îÄ MODELS (Generated by Notebooks)
‚îÇ   ‚îî‚îÄ‚îÄ models/
‚îÇ       ‚îú‚îÄ‚îÄ chroma_db/                   ‚ùå ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Å‡πà‡∏≤ (MiniLM)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chroma.sqlite3              - ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡∏≠‡∏ô‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏ó‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ [UUID]/                     
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ chroma_db_bge/               ‚≠ê ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ! (BGE embeddings)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chroma.sqlite3              - ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ f77d9e5f-.../               - Vector index
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ data_level0.bin
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ header.bin
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ length.bin
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ link_lists.bin
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ chunks/                      ‚ùå ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Å‡πà‡∏≤ (MiniLM)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ embeddings.npy              - 467 chunks
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chunk_metadata.csv
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chunks_data.json
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ chunking_summary.json
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ chunks_bge/                  ‚≠ê ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ! (BGE embeddings)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ embeddings.npy              - 933 chunks √ó 768 dim
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chunk_metadata.csv          - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• chunks
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chunks_data.json            - Full data
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ chunking_summary.json       - Config ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
‚îÇ       ‚îÇ
‚îÇ       ‚îî‚îÄ‚îÄ vector_db_summary.json       ‚ÑπÔ∏è ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ database


```

---

## üìã ‡∏™‡∏£‡∏∏‡∏õ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ vs ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ

###  ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

| ‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó | ‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£ |
|--------------|--------|-----------|
| **app_guardrail_bielik.py** | App | üöÄ ‡∏£‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ! |
| **.env** | Config | API keys |
| **requirements.txt** | Config | Dependencies |
| **data_rag/** | Data | ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ + ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö |
| **notebooks/02_chunking_embedding.ipynb** | Pipeline | ‡∏™‡∏£‡πâ‡∏≤‡∏á embeddings |
| **notebooks/03_vector_database.ipynb** | Pipeline | ‡∏™‡∏£‡πâ‡∏≤‡∏á ChromaDB |
| **models/chroma_db_bge/** | Database | Vector DB ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ |
| **models/chunks_bge/** | Data | Chunks + embeddings |

### ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß

| ‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå | ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• |
|--------------|--------|
| **app_guardrail_model.py** | ‡πÑ‡∏°‡πà‡∏û‡∏∂‡πà‡∏á‡∏û‡∏≤ gaudrail ‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà train ‡πÄ‡∏≠‡∏á ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞ |
| **models/chroma_db/** | ‡πÄ‡∏Å‡πà‡∏≤, accuracy ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ |
| **models/chunks/** | ‡πÄ‡∏Å‡πà‡∏≤, chunk ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô |
| **guardrail_script/** | ‡πÄ‡∏õ‡πá‡∏ô code ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡∏™‡∏¥‡∏™‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏ï‡∏±‡∏ß model ‡∏Å‡∏±‡∏ö data ‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞ ‡πÅ‡∏ï‡πà‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞ paper ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞ |


## ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```bash
# Clone repo
git clone <repo-url>
cd RAG_SERVICE

# ‡∏™‡∏£‡πâ‡∏≤‡∏á virtual environment
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á packages
pip install -r requirements.txt

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Streamlit
pip install streamlit chromadb google-generativeai python-dotenv transformers
```

### 2. Setup API Key

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏ó‡∏µ‡πà root:
```env
GEMINI_API_KEY=your_gemini_api_key_here
```

‡∏Ç‡∏≠ API key: https://makersuite.google.com/app/apikey

### 3. ‡∏£‡∏±‡∏ô Application

```bash
streamlit run app_guardrail_bielik.py
```

‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà: http://localhost:8501

---

## Pipeline (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà)

### ‡∏Å‡∏£‡∏ì‡∏µ models/ ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‚Üí ‡∏Ç‡πâ‡∏≤‡∏° Step ‡∏ô‡∏µ‡πâ

‡∏ñ‡πâ‡∏≤ `models/chroma_db_bge/` ‡πÅ‡∏•‡∏∞ `models/chunks_bge/` ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß:
```bash
# ‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!
streamlit run app_guardrail_bielik.py
```

### ‡∏Å‡∏£‡∏ì‡∏µ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Database ‡πÉ‡∏´‡∏°‡πà

**Step 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Chunks + Embeddings** (~3-5 ‡∏ô‡∏≤‡∏ó‡∏µ)
```bash
jupyter notebook notebooks/02_chunking_embedding.ipynb

# ‡∏£‡∏±‡∏ô cells ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
# Output: models/chunks_bge/
#   - embeddings.npy (933 chunks √ó 768 dim)
#   - chunk_metadata.csv
#   - chunks_data.json
```

**Step 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á ChromaDB** (~1-2 ‡∏ô‡∏≤‡∏ó‡∏µ)
```bash
jupyter notebook notebooks/03_vector_database.ipynb

# ‡∏£‡∏±‡∏ô cells ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
# Output: models/chroma_db_bge/
```

**Step 3: ‡∏£‡∏±‡∏ô App**
```bash
streamlit run app_guardrail_bielik.py
```

---

## Features

### RAG System
-  **933 chunks** (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 467 - ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô)
-  **BGE-base-en-v1.5** embeddings (768 ‡∏°‡∏¥‡∏ï‡∏¥ - ‡πÅ‡∏°‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤ MiniLM 5-8%)
-  **Chunk size 156 ‡∏Ñ‡∏≥** (‡πÄ‡∏î‡∏¥‡∏° 300 - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á‡∏Å‡∏ß‡πà‡∏≤)
-  Semantic search ‡∏î‡πâ‡∏ß‡∏¢ ChromaDB
-  ‡∏õ‡∏£‡∏±‡∏ö similarity threshold ‡πÑ‡∏î‡πâ

### Safety Guardrails
-  **Bielik-Guard 0.1B** - AI model ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
-  Topic blocking (‡∏®‡∏≤‡∏™‡∏ô‡∏≤, ‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á)
-  Keyword filtering
-  ‡∏õ‡∏£‡∏±‡∏ö sensitivity ‡πÑ‡∏î‡πâ (0.3-0.9)

### UI (Streamlit)
-  Web interface ‡∏™‡∏∞‡∏î‡∏ß‡∏Å
-  ‡πÅ‡∏™‡∏î‡∏á similarity scores
-  ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà retrieve ‡∏°‡∏≤
-  Safety controls ‡πÅ‡∏ö‡∏ö real-time

---

##  Performance

### ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Old vs New

| Metric | ‡πÄ‡∏î‡∏¥‡∏° (MiniLM + 300 words) | ‡πÉ‡∏´‡∏°‡πà (BGE + 156 words) | ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô |
|--------|---------------------------|------------------------|--------|
| **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Chunks** | 467 | **933** | +100% |
| **Avg Similarity** | 0.47 | **0.62** | +32%  |
| **Top-1 Accuracy** | 68% | **85%** | +17%  |
| **Query Time** | 15ms | 18ms | -20% |

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°

```python
‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: "What drops a key upon death?"

‡πÄ‡∏î‡∏¥‡∏°:
‚îú‚îÄ Model: all-MiniLM-L6-v2
‚îú‚îÄ Chunk: 300 words
‚îî‚îÄ Similarity: 0.47 ‚ùå (‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô, ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô threshold)

‡πÉ‡∏´‡∏°‡πà:
‚îú‚îÄ Model: BGE-base-en-v1.5
‚îú‚îÄ Chunk: 156 words
‚îî‚îÄ Similarity: 0.65  (‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô 38%!)
```

---

##  Configuration

### Chunking Settings

‡∏î‡∏π‡πÉ‡∏ô `models/chunks_bge/chunking_summary.json`:
```json
{
  "num_documents": 20,
  "num_chunks": 933,
  "chunk_size": 156,        // ‡∏Ñ‡∏≥‡∏ï‡πà‡∏≠ chunk (‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á = ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á)
  "overlap": 31,            // ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà overlap (20% ‡∏Ç‡∏≠‡∏á chunk_size)
  "embedding_model": "BAAI/bge-base-en-v1.5",
  "embedding_dim": 768
}
```

**‡∏ó‡∏≥‡πÑ‡∏°‡πÉ‡∏ä‡πâ settings ‡∏ô‡∏µ‡πâ?**
-  Chunk 156 ‡∏Ñ‡∏≥ ‚Üí ‡πÄ‡∏•‡πá‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° (300) ‚Üí similarity ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
-  BGE-base ‚Üí ‡πÅ‡∏°‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤ MiniLM 5-8%
-  933 chunks ‚Üí ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ 467 chunks

### Retrieval Settings

‡πÉ‡∏ô `app_guardrail_bielik.py` ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 71:
```python
def retrieve_documents(
    query: str, 
    min_similarity: float = 0.5,  #  ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    top_k: int = 8                #  ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô chunks
):
```
---

## Models ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### 1. Embedding: BGE-Base-EN-v1.5 

```python
from sentence_transformers import SentenceTransformer
model = SentenceTransformer('BAAI/bge-base-en-v1.5')
```

**Specs:**
- Dimensions: 768
- Accuracy: 84-87% (MTEB benchmark)
- Developer: Beijing Academy of AI
- License: MIT

**‡∏ó‡∏≥‡πÑ‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å BGE?**
-  ‡πÅ‡∏°‡πà‡∏ô‡∏Å‡∏ß‡πà‡∏≤ MiniLM 5-8%
-  Rank #1 ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ö‡∏ô MTEB
-  v1.5 ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç similarity distribution

### 2. Safety: Bielik-Guard-0.1B 

```python
from transformers import pipeline
guard = pipeline("text-classification", model="speakleash/Bielik-Guard-0.1B-v1.0")
```

**Specs:**
- Size: 100M parameters
- Categories: Safe / Harmful / Neutral
- Purpose: Content moderation

### 3. LLM: Google Gemini 

```python
import google.generativeai as genai
genai.configure(api_key=os.getenv("GEMINI_API_KEY"))
model = genai.GenerativeModel('gemini-2.5-flash')
```

**Model:** gemini-pro (text generation)

---

##  Quick Commands

```bash
# ‡∏£‡∏±‡∏ô app
streamlit run app_guardrail_bielik.py

# Rebuild database (‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
jupyter notebook notebooks/02_chunking_embedding.ipynb  # 3-5 ‡∏ô‡∏≤‡∏ó‡∏µ
jupyter notebook notebooks/03_vector_database.ipynb     # 1-2 ‡∏ô‡∏≤‡∏ó‡∏µ

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö configuration
cat models/chunks_bge/chunking_summary.json
```
