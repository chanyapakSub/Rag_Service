# ğŸ¤– RAG Chatbot with Guardrails

Chatbot à¸—à¸µà¹ˆà¸•à¸­à¸šà¸„à¸³à¸–à¸²à¸¡à¸ˆà¸²à¸ documents à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ RAG (Retrieval-Augmented Generation) à¸à¸£à¹‰à¸­à¸¡à¸£à¸°à¸šà¸šà¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢à¸‚à¸­à¸‡à¸„à¸³à¸•à¸­à¸š

## à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸³à¸‡à¸²à¸™

à¸£à¸°à¸šà¸šà¸™à¸µà¹‰à¸—à¸³à¸‡à¸²à¸™ 3 à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™:
1. **Search**: à¸«à¸²à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸ˆà¸²à¸ documents (933 chunks)
2. **Generate**: à¹ƒà¸Šà¹‰ Gemini API à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸³à¸•à¸­à¸šà¸ˆà¸²à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸«à¸²à¹„à¸”à¹‰
3. **Filter**: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸„à¸³à¸•à¸­à¸šà¸›à¸¥à¸­à¸”à¸ à¸±à¸¢à¸”à¹‰à¸§à¸¢ Bielik-Guard + keyword filtering

---

## ğŸ“ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œ

```
RAG_SERVICE/
â”‚
â”œâ”€â”€  APPLICATIONS (à¹€à¸¥à¸·à¸­à¸à¸£à¸±à¸™à¸•à¸±à¸§à¹ƒà¸”à¸•à¸±à¸§à¸«à¸™à¸¶à¹ˆà¸‡)
â”‚   â”œâ”€â”€ app_guardrail_bielik.py          â­ à¹ƒà¸Šà¹‰à¸•à¸±à¸§à¸™à¸µà¹‰ (à¹à¸™à¸°à¸™à¸³!)
â”‚   â”‚                                       - à¹ƒà¸Šà¹‰ Bielik-Guard AI model
â”‚   â”‚                                       - à¹ƒà¸Šà¹‰ BGE-base embeddings (à¹à¸¡à¹ˆà¸™à¸à¸§à¹ˆà¸²)
â”‚   â”‚                                       - UI à¸„à¸£à¸š, settings à¸›à¸£à¸±à¸šà¹„à¸”à¹‰à¹€à¸¢à¸­à¸°
â”‚   â”‚
â”‚   â””â”€â”€ app_guardrail_model.py           âŒ à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¹€à¸à¹ˆà¸² (à¹„à¸¡à¹ˆà¹à¸™à¸°à¸™à¸³)
â”‚                                           - à¹ƒà¸Šà¹‰ custom XGBoost
â”‚                                           - à¹ƒà¸Šà¹‰ MiniLM (accuracy à¸•à¹ˆà¸³à¸à¸§à¹ˆà¸²)
â”‚
â”œâ”€â”€ CONFIGURATION
â”‚   â”œâ”€â”€ .env                             âœ… à¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸­à¸‡! (à¹ƒà¸ªà¹ˆ GEMINI_API_KEY)
â”‚   â”œâ”€â”€ requirements.txt                 âœ… à¹ƒà¸Šà¹‰à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
â”‚   â””â”€â”€ README.md                        ğŸ“– à¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰
â”‚
â”œâ”€â”€ DATA
â”‚   â””â”€â”€ data_rag/
â”‚       â”œâ”€â”€ documents.csv                        âœ… à¹€à¸­à¸à¸ªà¸²à¸£à¸•à¹‰à¸™à¸‰à¸šà¸±à¸š (20 docs)
â”‚       â”œâ”€â”€ single_passage_answer_questions.csv  âœ… à¸—à¸”à¸ªà¸­à¸š (40 à¸„à¸³à¸–à¸²à¸¡)
â”‚       â”œâ”€â”€ multi_passage_answer_questions.csv   âœ… à¸—à¸”à¸ªà¸­à¸š (40 à¸„à¸³à¸–à¸²à¸¡)
â”‚       â””â”€â”€ no_answer_questions.csv              âœ… à¸—à¸”à¸ªà¸­à¸š (40 à¸„à¸³à¸–à¸²à¸¡)
â”‚
â”œâ”€â”€ NOTEBOOKS (Pipeline à¸ªà¸£à¹‰à¸²à¸‡ RAG System)
â”‚   â””â”€â”€ notebooks/
â”‚       â”œâ”€â”€ 01_eda.ipynb                 â„¹ï¸ Optional - à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
â”‚       â”‚                                   â†’ à¸ªà¸£à¹‰à¸²à¸‡ eda_summary.json
â”‚       â”‚
â”‚       â”œâ”€â”€ 02_chunking_embedding.ipynb  â­ à¸ªà¸³à¸„à¸±à¸! - à¸ªà¸£à¹‰à¸²à¸‡ embeddings
â”‚       â”‚                                   Input: documents.csv
â”‚       â”‚                                   Output: chunks_bge/
â”‚       â”‚                                   à¹€à¸§à¸¥à¸²: ~3-5 à¸™à¸²à¸—à¸µ
â”‚       â”‚
â”‚       â”œâ”€â”€ 03_vector_database.ipynb     â­ à¸ªà¸³à¸„à¸±à¸! - à¸ªà¸£à¹‰à¸²à¸‡ ChromaDB
â”‚       â”‚                                   Input: chunks_bge/
â”‚       â”‚                                   Output: chroma_db_bge/
â”‚       â”‚                                   à¹€à¸§à¸¥à¸²: ~1-2 à¸™à¸²à¸—à¸µ
â”‚       â”‚
â”‚       â””â”€â”€ eda_summary.json             â„¹ï¸ Output à¸ˆà¸²à¸ notebook 1
â”‚
â”œâ”€â”€ GUARDRAIL (Optional - à¸ªà¸³à¸«à¸£à¸±à¸š train custom model)
â”‚   â””â”€â”€ guardrail_script/
â”‚       â”œâ”€â”€ train_binary.ipynb           âŒ à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹ƒà¸™à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™
â”‚       â””â”€â”€ test_benchmark.ipynb         âŒ à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹ƒà¸™à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™
â”‚           (à¹ƒà¸Šà¹‰ Bielik-Guard à¹à¸—à¸™ - à¸”à¸µà¸à¸§à¹ˆà¸²)
â”‚
â”œâ”€â”€ MODELS (Generated by Notebooks)
â”‚   â””â”€â”€ models/
â”‚       â”œâ”€â”€ chroma_db/                   âŒ à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¹€à¸à¹ˆà¸² (MiniLM)
â”‚       â”‚   â”œâ”€â”€ chroma.sqlite3              - à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹à¸¥à¹‰à¸§
â”‚       â”‚   â””â”€â”€ [UUID]/                     - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¹ˆà¸²
â”‚       â”‚
â”‚       â”œâ”€â”€ chroma_db_bge/               â­ à¹ƒà¸Šà¹‰à¸•à¸±à¸§à¸™à¸µà¹‰! (BGE embeddings)
â”‚       â”‚   â”œâ”€â”€ chroma.sqlite3              - à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¸¥à¸±à¸
â”‚       â”‚   â””â”€â”€ f77d9e5f-.../               - Vector index
â”‚       â”‚       â”œâ”€â”€ data_level0.bin
â”‚       â”‚       â”œâ”€â”€ header.bin
â”‚       â”‚       â”œâ”€â”€ length.bin
â”‚       â”‚       â””â”€â”€ link_lists.bin
â”‚       â”‚
â”‚       â”œâ”€â”€ chunks/                      âŒ à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¹€à¸à¹ˆà¸² (MiniLM)
â”‚       â”‚   â”œâ”€â”€ embeddings.npy              - 467 chunks
â”‚       â”‚   â”œâ”€â”€ chunk_metadata.csv
â”‚       â”‚   â”œâ”€â”€ chunks_data.json
â”‚       â”‚   â””â”€â”€ chunking_summary.json
â”‚       â”‚
â”‚       â”œâ”€â”€ chunks_bge/                  â­ à¹ƒà¸Šà¹‰à¸•à¸±à¸§à¸™à¸µà¹‰! (BGE embeddings)
â”‚       â”‚   â”œâ”€â”€ embeddings.npy              - 933 chunks Ã— 768 dim
â”‚       â”‚   â”œâ”€â”€ chunk_metadata.csv          - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ chunks
â”‚       â”‚   â”œâ”€â”€ chunks_data.json            - Full data
â”‚       â”‚   â””â”€â”€ chunking_summary.json       - Config à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰
â”‚       â”‚
â”‚       â””â”€â”€ vector_db_summary.json       â„¹ï¸ à¸ªà¸–à¸´à¸•à¸´ database


```

---

## ğŸ“‹ à¸ªà¸£à¸¸à¸›à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ vs à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰

###  à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸ˆà¸£à¸´à¸‡

| à¹„à¸Ÿà¸¥à¹Œ/à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ | à¸›à¸£à¸°à¹€à¸ à¸— | à¹ƒà¸Šà¹‰à¸—à¸³à¸­à¸°à¹„à¸£ |
|--------------|--------|-----------|
| **app_guardrail_bielik.py** | App | ğŸš€ à¸£à¸±à¸™à¸•à¸±à¸§à¸™à¸µà¹‰! |
| **.env** | Config | API keys |
| **requirements.txt** | Config | Dependencies |
| **data_rag/** | Data | à¹€à¸­à¸à¸ªà¸²à¸£ + à¸„à¸³à¸–à¸²à¸¡à¸—à¸”à¸ªà¸­à¸š |
| **notebooks/02_chunking_embedding.ipynb** | Pipeline | à¸ªà¸£à¹‰à¸²à¸‡ embeddings |
| **notebooks/03_vector_database.ipynb** | Pipeline | à¸ªà¸£à¹‰à¸²à¸‡ ChromaDB |
| **models/chroma_db_bge/** | Database | Vector DB à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
| **models/chunks_bge/** | Data | Chunks + embeddings |

### à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹à¸¥à¹‰à¸§

| à¹„à¸Ÿà¸¥à¹Œ/à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ | à¹€à¸«à¸•à¸¸à¸œà¸¥ |
|--------------|--------|
| **app_guardrail_model.py** | à¹ƒà¸Šà¹‰M |
| **models/chroma_db/** | à¹€à¸à¹ˆà¸², accuracy à¸•à¹ˆà¸³à¸à¸§à¹ˆà¸² |
| **models/chunks/** | à¹€à¸à¹ˆà¸², chunk à¸‚à¸™à¸²à¸”à¹ƒà¸«à¸à¹ˆà¹€à¸à¸´à¸™ |
| **guardrail_script/** | à¹ƒà¸Šà¹‰ Bielik-Guard à¹à¸—à¸™ |
| **notebooks/01_eda.ipynb** | Optional, à¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™ |
| **.history/** | VS Code history |

### â„¹ï¸ à¹„à¸Ÿà¸¥à¹Œ Optional

| à¹„à¸Ÿà¸¥à¹Œ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ |
|------|---------|
| **notebooks/01_eda.ipynb** | à¹ƒà¸Šà¹‰à¸–à¹‰à¸²à¸­à¸¢à¸²à¸à¹€à¸«à¹‡à¸™à¸ªà¸–à¸´à¸•à¸´à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ |
| **notebooks/eda_summary.json** | Output à¸ˆà¸²à¸ EDA |
| **models/vector_db_summary.json** | à¸ªà¸–à¸´à¸•à¸´ database |

---

## ğŸš€ à¸§à¸´à¸˜à¸µà¹ƒà¸Šà¹‰à¸‡à¸²à¸™

### 1. à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ Dependencies

```bash
# Clone repo
git clone <repo-url>
cd RAG_SERVICE

# à¸ªà¸£à¹‰à¸²à¸‡ virtual environment
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ packages
pip install -r requirements.txt

# à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹€à¸à¸´à¹ˆà¸¡à¸ªà¸³à¸«à¸£à¸±à¸š Streamlit
pip install streamlit chromadb google-generativeai python-dotenv transformers
```

### 2. Setup API Key

à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ `.env` à¸—à¸µà¹ˆ root:
```env
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_API_KEY2=your_backup_key  # optional
```

à¸‚à¸­ API key: https://makersuite.google.com/app/apikey

### 3. à¸£à¸±à¸™ Application

```bash
streamlit run app_guardrail_bielik.py
```

à¹€à¸›à¸´à¸”à¹€à¸šà¸£à¸²à¸§à¹Œà¹€à¸‹à¸­à¸£à¹Œà¸—à¸µà¹ˆ: http://localhost:8501

---

## ğŸ”„ Pipeline (à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸«à¸¡à¹ˆ)

### à¸à¸£à¸“à¸µ models/ à¸¡à¸µà¹„à¸Ÿà¸¥à¹Œà¸„à¸£à¸šà¹à¸¥à¹‰à¸§ â†’ à¸‚à¹‰à¸²à¸¡ Step à¸™à¸µà¹‰

à¸–à¹‰à¸² `models/chroma_db_bge/` à¹à¸¥à¸° `models/chunks_bge/` à¸¡à¸µà¹„à¸Ÿà¸¥à¹Œà¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§:
```bash
# à¸£à¸±à¸™à¹„à¸”à¹‰à¹€à¸¥à¸¢!
streamlit run app_guardrail_bielik.py
```

### à¸à¸£à¸“à¸µà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡ Database à¹ƒà¸«à¸¡à¹ˆ

**Step 1: à¸ªà¸£à¹‰à¸²à¸‡ Chunks + Embeddings** (~3-5 à¸™à¸²à¸—à¸µ)
```bash
jupyter notebook notebooks/02_chunking_embedding.ipynb

# à¸£à¸±à¸™ cells à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
# Output: models/chunks_bge/
#   - embeddings.npy (933 chunks Ã— 768 dim)
#   - chunk_metadata.csv
#   - chunks_data.json
```

**Step 2: à¸ªà¸£à¹‰à¸²à¸‡ ChromaDB** (~1-2 à¸™à¸²à¸—à¸µ)
```bash
jupyter notebook notebooks/03_vector_database.ipynb

# à¸£à¸±à¸™ cells à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
# Output: models/chroma_db_bge/
```

**Step 3: à¸£à¸±à¸™ App**
```bash
streamlit run app_guardrail_bielik.py
```

---

## ğŸ’¡ Features

### RAG System
- âœ… **933 chunks** (à¹€à¸à¸´à¹ˆà¸¡à¸ˆà¸²à¸ 467 - à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸¡à¸²à¸à¸‚à¸¶à¹‰à¸™)
- âœ… **BGE-base-en-v1.5** embeddings (768 à¸¡à¸´à¸•à¸´ - à¹à¸¡à¹ˆà¸™à¸à¸§à¹ˆà¸² MiniLM 5-8%)
- âœ… **Chunk size 156 à¸„à¸³** (à¹€à¸”à¸´à¸¡ 300 - à¹€à¸‰à¸à¸²à¸°à¹€à¸ˆà¸²à¸°à¸ˆà¸‡à¸à¸§à¹ˆà¸²)
- âœ… Semantic search à¸”à¹‰à¸§à¸¢ ChromaDB
- âœ… à¸›à¸£à¸±à¸š similarity threshold à¹„à¸”à¹‰

### Safety Guardrails
- âœ… **Bielik-Guard 0.1B** - AI model à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸™à¸·à¹‰à¸­à¸«à¸²
- âœ… Topic blocking (à¸¨à¸²à¸ªà¸™à¸², à¸à¸²à¸£à¹€à¸¡à¸·à¸­à¸‡, à¸„à¸§à¸²à¸¡à¸£à¸¸à¸™à¹à¸£à¸‡)
- âœ… Keyword filtering
- âœ… à¸›à¸£à¸±à¸š sensitivity à¹„à¸”à¹‰ (0.3-0.9)

### UI (Streamlit)
- âœ… Web interface à¸ªà¸°à¸”à¸§à¸
- âœ… à¹à¸ªà¸”à¸‡ similarity scores
- âœ… à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆ retrieve à¸¡à¸²
- âœ… Safety controls à¹à¸šà¸š real-time

---

## ğŸ“Š Performance

### à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸š Old vs New

| Metric | à¹€à¸”à¸´à¸¡ (MiniLM + 300 words) | à¹ƒà¸«à¸¡à¹ˆ (BGE + 156 words) | à¸”à¸µà¸‚à¸¶à¹‰à¸™ |
|--------|---------------------------|------------------------|--------|
| **à¸ˆà¸³à¸™à¸§à¸™ Chunks** | 467 | **933** | +100% |
| **Avg Similarity** | 0.47 | **0.62** | +32% âœ… |
| **Top-1 Accuracy** | 68% | **85%** | +17% âœ… |
| **Query Time** | 15ms | 18ms | -20% |

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸„à¸³à¸–à¸²à¸¡

```python
à¸„à¸³à¸–à¸²à¸¡: "What drops a key upon death?"

à¹€à¸”à¸´à¸¡:
â”œâ”€ Model: all-MiniLM-L6-v2
â”œâ”€ Chunk: 300 words
â””â”€ Similarity: 0.47 âŒ (à¸•à¹ˆà¸³à¹€à¸à¸´à¸™, à¸­à¸²à¸ˆà¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ threshold)

à¹ƒà¸«à¸¡à¹ˆ:
â”œâ”€ Model: BGE-base-en-v1.5
â”œâ”€ Chunk: 156 words
â””â”€ Similarity: 0.65 âœ… (à¸ªà¸¹à¸‡à¸‚à¸¶à¹‰à¸™ 38%!)
```

---

## ğŸ”§ Configuration

### Chunking Settings

à¸”à¸¹à¹ƒà¸™ `models/chunks_bge/chunking_summary.json`:
```json
{
  "num_documents": 20,
  "num_chunks": 933,
  "chunk_size": 156,        // à¸„à¸³à¸•à¹ˆà¸­ chunk (à¹€à¸¥à¹‡à¸à¸¥à¸‡ = à¹€à¸‰à¸à¸²à¸°à¹€à¸ˆà¸²à¸°à¸ˆà¸‡)
  "overlap": 31,            // à¸„à¸³à¸—à¸µà¹ˆ overlap (20% à¸‚à¸­à¸‡ chunk_size)
  "embedding_model": "BAAI/bge-base-en-v1.5",
  "embedding_dim": 768
}
```

**à¸—à¸³à¹„à¸¡à¹ƒà¸Šà¹‰ settings à¸™à¸µà¹‰?**
- âœ… Chunk 156 à¸„à¸³ â†’ à¹€à¸¥à¹‡à¸à¸à¸§à¹ˆà¸²à¹€à¸”à¸´à¸¡ (300) â†’ similarity à¸ªà¸¹à¸‡à¸‚à¸¶à¹‰à¸™
- âœ… BGE-base â†’ à¹à¸¡à¹ˆà¸™à¸à¸§à¹ˆà¸² MiniLM 5-8%
- âœ… 933 chunks â†’ à¸„à¸£à¸­à¸šà¸„à¸¥à¸¸à¸¡à¸”à¸µà¸à¸§à¹ˆà¸² 467 chunks

### Retrieval Settings

à¹ƒà¸™ `app_guardrail_bielik.py` à¸šà¸£à¸£à¸—à¸±à¸” 71:
```python
def retrieve_documents(
    query: str, 
    min_similarity: float = 0.5,  # â¬…ï¸ à¸›à¸£à¸±à¸šà¸•à¸£à¸‡à¸™à¸µà¹‰
    top_k: int = 8                # â¬…ï¸ à¸ˆà¸³à¸™à¸§à¸™ chunks
):
```

**à¹à¸™à¸°à¸™à¸³:**
- `min_similarity = 0.5` - Balanced (default) âœ…
- `min_similarity = 0.3` - More permissive (à¹€à¸­à¸² context à¹€à¸¢à¸­à¸°)
- `min_similarity = 0.7` - Strict (à¹€à¸‰à¸à¸²à¸°à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸¡à¸²à¸)

---

## ğŸ› Troubleshooting

### à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸à¸šà¸šà¹ˆà¸­à¸¢

**1. "No Chroma collections found"**
```bash
# à¸ªà¸£à¹‰à¸²à¸‡ database à¹ƒà¸«à¸¡à¹ˆ
jupyter notebook notebooks/03_vector_database.ipynb
```

**2. "API key not found"**
```bash
# à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ .env
echo "GEMINI_API_KEY=your_key_here" > .env
```

**3. Similarity scores à¸•à¹ˆà¸³à¹€à¸à¸´à¸™à¹„à¸›**

à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¹ƒà¸Šà¹‰ model à¸–à¸¹à¸:
```bash
# à¹€à¸Šà¹‡à¸„à¹ƒà¸™ models/chunks_bge/chunking_summary.json
cat models/chunks_bge/chunking_summary.json | grep embedding_model

# à¸„à¸§à¸£à¹€à¸›à¹‡à¸™: "BAAI/bge-base-en-v1.5"
```

**4. App à¸Šà¹‰à¸²à¹€à¸à¸´à¸™à¹„à¸›**

à¸¥à¸” `top_k`:
```python
# à¹ƒà¸™ app_guardrail_bielik.py
def retrieve_documents(query, min_similarity=0.5, top_k=5):  # à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸ 8
```

**5. "Module not found"**
```bash
pip install <missing-module>
# à¸«à¸£à¸·à¸­
pip install -r requirements.txt
```

---

## ğŸ¤– Models à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰

### 1. Embedding: BGE-Base-EN-v1.5 â­

```python
from sentence_transformers import SentenceTransformer
model = SentenceTransformer('BAAI/bge-base-en-v1.5')
```

**Specs:**
- Dimensions: 768
- Accuracy: 84-87% (MTEB benchmark)
- Developer: Beijing Academy of AI
- License: MIT

**à¸—à¸³à¹„à¸¡à¹€à¸¥à¸·à¸­à¸ BGE?**
- âœ… à¹à¸¡à¹ˆà¸™à¸à¸§à¹ˆà¸² MiniLM 5-8%
- âœ… Rank #1 à¸‚à¸™à¸²à¸”à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™à¸šà¸™ MTEB
- âœ… v1.5 à¹à¸à¹‰à¹„à¸‚ similarity distribution

### 2. Safety: Bielik-Guard-0.1B ğŸ›¡ï¸

```python
from transformers import pipeline
guard = pipeline("text-classification", model="speakleash/Bielik-Guard-0.1B-v1.0")
```

**Specs:**
- Size: 100M parameters
- Categories: Safe / Harmful / Neutral
- Purpose: Content moderation

### 3. LLM: Google Gemini ğŸ’¬

```python
import google.generativeai as genai
genai.configure(api_key=os.getenv("GEMINI_API_KEY"))
model = genai.GenerativeModel('gemini-pro')
```

**Model:** gemini-pro (text generation)

---

## ğŸ“š à¹€à¸­à¸à¸ªà¸²à¸£à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡

- [BGE Models](https://github.com/FlagOpen/FlagEmbedding)
- [ChromaDB Docs](https://docs.trychroma.com/)
- [Streamlit Docs](https://docs.streamlit.io/)
- [MTEB Leaderboard](https://huggingface.co/spaces/mteb/leaderboard)

---

## âš¡ Quick Commands

```bash
# à¸£à¸±à¸™ app
streamlit run app_guardrail_bielik.py

# Rebuild database (à¸–à¹‰à¸²à¸ˆà¸³à¹€à¸›à¹‡à¸™)
jupyter notebook notebooks/02_chunking_embedding.ipynb  # 3-5 à¸™à¸²à¸—à¸µ
jupyter notebook notebooks/03_vector_database.ipynb     # 1-2 à¸™à¸²à¸—à¸µ

# à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š configuration
cat models/chunks_bge/chunking_summary.json
```

---

## ğŸ“ Credits

**Models:**
- BGE: Beijing Academy of AI
- Bielik-Guard: Speakleash  
- Gemini: Google

**Libraries:**
- Sentence Transformers
- ChromaDB
- Streamlit

---

Made with â˜• - à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸ˆà¸£à¸´à¸‡
